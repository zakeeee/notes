# 带符号的大数相加

```java
import java.util.Stack;

public class Main {
    static class ListNode {
        char val;
        ListNode next;

        ListNode(char val) {
            this.val = val;
        }
    }

    public static ListNode addTwoList(ListNode l1, ListNode l2) {
        ListNode cur;
        boolean sign1 = l1.val == '-', sign2 = l2.val == '-';
        if (sign1 != sign2) {
            // 异号，两数相减
            l1 = sign1 ? l1.next : l1;  // 去除符号
            l2 = sign2 ? l2.next : l2;  // 去除符号
            cur = sub(l1, l2);
            
        } else {
            // 同号，两数相加
            l1 = sign1 ? l1.next : l1;  // 去除符号
            l2 = sign2 ? l2.next : l2;  // 去除符号
            cur = add(l1, l2);
            // 如果是负号就要在结果上加一个负号
            if (sign1) {
                ListNode node = new ListNode('-');
                node.next = cur;
                cur = node;
            }
        }
        return cur;
    }

    // 无符号相加
    private static ListNode add(ListNode l1, ListNode l2) {
        Stack<Integer> s1 = new Stack<>(), s2 = new Stack<>();
        while (l1 != null) {
            s1.push(l1.val - '0');
            l1 = l1.next;
        }
        while (l2 != null) {
            s2.push(l2.val - '0');
            l2 = l2.next;
        }

        ListNode cur = null;
        int carry = 0;
        while (!s1.isEmpty() || !s2.isEmpty() || carry != 0) {
            if (!s1.isEmpty()) carry += s1.pop();
            if (!s2.isEmpty()) carry += s2.pop();
            ListNode node = new ListNode((char) ((char) carry % 10 + '0'));
            node.next = cur;
            cur = node;
            carry /= 10;
        }
        return cur;
    }

    // 无符号相减
    private static ListNode sub(ListNode l1, ListNode l2) {
        Stack<Integer> s1 = new Stack<>(), s2 = new Stack<>();
        ListNode c1 = l1, c2 = l2;
        while (c1 != null) {
            s1.push(c1.val - '0');
            c1 = c1.next;
        }
        while (c2 != null) {
            s2.push(c2.val - '0');
            c2 = c2.next;
        }

        // 保证 s1 的数字大于等于 s2 的数字
        if (compare(l1, l2) < 0) {
            Stack<Integer> tmp = s1;
            s1 = s2;
            s2 = tmp;
        }

        ListNode cur = null;
        int carry = 0;
        while (!s1.isEmpty() && !s2.isEmpty()) {
            carry += s1.pop();
            carry -= s2.pop();
            if (carry < 0) {
                ListNode node = new ListNode((char) ((char) carry + 10 + '0'));
                node.next = cur;
                cur = node;
                carry = -1;
            } else {
                ListNode node = new ListNode((char) ((char) carry + '0'));
                node.next = cur;
                cur = node;
                carry = 0;
            }
        }
        return cur;
    }

    private static int len(ListNode l1) {
        int len = 0;
        while (l1 != null) {
            len++;
            l1 = l1.next;
        }
        return len;
    }

    private static int compare(ListNode l1, ListNode l2) {
        int len1 = len(l1), len2 = len(l2);
        if (len1 == len2) {
            while (l1 != null) {
                if (l1.val != l2.val) return l1.val - l2.val;
                else {
                    l1 = l1.next;
                    l2 = l2.next;
                }
            }
            return 0;
        } else {
            return len1 - len2;
        }
    }

    public static ListNode create(String str) {
        ListNode dummy = new ListNode('0'), cur = dummy;
        for (char ch : str.toCharArray()) {
            cur.next = new ListNode(ch);
            cur = cur.next;
        }
        return dummy.next;
    }

    public static void main(String[] args) {
        ListNode l1 = create("-132");
        ListNode l2 = create("-77");
        ListNode res = addTwoList(l1, l2), cur = res;
        StringBuilder builder = new StringBuilder();
        while (cur != null) {
            builder.append(cur.val);
            cur = cur.next;
        }
        System.out.println(builder.toString());
    }
}
```